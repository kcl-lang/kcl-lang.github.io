"use strict";(self.webpackChunkkcl_website=self.webpackChunkkcl_website||[]).push([[88782],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=p(n),d=i,g=c["".concat(s,".").concat(d)]||c[d]||u[d]||r;return n?a.createElement(g,l(l({ref:t},m),{},{components:n})):a.createElement(g,l({ref:t},m))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},90843:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(87462),i=(n(67294),n(3905));const r={slug:"2023-12-07-biweekly-newsletter",title:"KCL Biweekly Newsletter (2023 11.24 - 12.07) | How to Use Different Kubernetes Patch Strategies in KCL?",authors:{name:"KCL Team",title:"KCL Team"},tags:["KCL","Biweekly-Newsletter"],image:"/img/biweekly-newsletter.png"},l=void 0,o={permalink:"/blog/2023-12-07-biweekly-newsletter",editUrl:"https://github.com/kcl-lang/kcl-lang.io/tree/main/blog/2023-12-07-biweekly-newsletter/index.md",source:"@site/blog/2023-12-07-biweekly-newsletter/index.md",title:"KCL Biweekly Newsletter (2023 11.24 - 12.07) | How to Use Different Kubernetes Patch Strategies in KCL?",description:"KCL is a constraint-based record and functional language hosted by Cloud Native Computing Foundation (CNCF) that enhances the writing of complex configurations, including those for cloud-native scenarios. With its advanced programming language technology and practices, KCL is dedicated to promoting better modularity, scalability, and stability for configurations. It enables simpler logic writing and offers ease of automation APIs and integration with homegrown systems.",date:"2023-12-07T00:00:00.000Z",formattedDate:"December 7, 2023",tags:[{label:"KCL",permalink:"/blog/tags/kcl"},{label:"Biweekly-Newsletter",permalink:"/blog/tags/biweekly-newsletter"}],readingTime:4.67,hasTruncateMarker:!1,authors:[{name:"KCL Team",title:"KCL Team"}],frontMatter:{slug:"2023-12-07-biweekly-newsletter",title:"KCL Biweekly Newsletter (2023 11.24 - 12.07) | How to Use Different Kubernetes Patch Strategies in KCL?",authors:{name:"KCL Team",title:"KCL Team"},tags:["KCL","Biweekly-Newsletter"],image:"/img/biweekly-newsletter.png"},prevItem:{title:"Unlocking Advanced Code Intelligence with the KCL Semantic Model",permalink:"/blog/2023-12-09-kcl-new-semantic-model"},nextItem:{title:"KCL v0.7.0 Release Blog",permalink:"/blog/2023-11-30-kcl-0.7.0-release"}},s={authorsImageUrls:[void 0]},p=[{value:"Overview",id:"overview",level:2},{value:"Special Thanks",id:"special-thanks",level:2},{value:"Featured Updates",id:"featured-updates",level:2},{value:"Using Kubernetes Strategy Merge Patch to Update Configurations in KCL",id:"using-kubernetes-strategy-merge-patch-to-update-configurations-in-kcl",level:3},{value:"Resources",id:"resources",level:2}],m={toc:p},c="wrapper";function u(e){let{components:t,...r}=e;return(0,i.kt)(c,(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(57702).Z,width:"1141",height:"435"})),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/kcl-lang"},"KCL")," is a constraint-based record and functional language hosted by Cloud Native Computing Foundation (CNCF) that enhances the writing of complex configurations, including those for cloud-native scenarios. With its advanced programming language technology and practices, KCL is dedicated to promoting better modularity, scalability, and stability for configurations. It enables simpler logic writing and offers ease of automation APIs and integration with homegrown systems."),(0,i.kt)("p",null,"This section will update the KCL language community's latest developments every two weeks, including features, website updates, and the latest community news, helping everyone better understand the KCL community!"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"KCL Website: ",(0,i.kt)("a",{parentName:"em",href:"https://kcl-lang.io"},"https://kcl-lang.io")))),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"Thank you to all contributors for their outstanding work over the past two weeks (11.24 - 12.07 2023). Here is an overview of the key content:"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\ud83d\udce6 Module Update")),(0,i.kt)("p",null,"The number of KCL models has increased to ",(0,i.kt)("strong",{parentName:"p"},"240"),", mainly including models related to Crossplane Provider and libraries related to JSON merging operations."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"KCL JSON Patch library:",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://artifacthub.io/packages/kcl/kcl-module/jsonpatch"},"https://artifacthub.io/packages/kcl/kcl-module/jsonpatch"))),(0,i.kt)("li",{parentName:"ul"},"KCL JSON Merge Patch library: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://artifacthub.io/packages/kcl/kcl-module/json_merge_patch"},"https://artifacthub.io/packages/kcl/kcl-module/json_merge_patch"))),(0,i.kt)("li",{parentName:"ul"},"KCL Kubernetes Strategy Merge Patch library: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://artifacthub.io/packages/kcl/kcl-module/strategic_merge_patch"},"https://artifacthub.io/packages/kcl/kcl-module/strategic_merge_patch"))),(0,i.kt)("li",{parentName:"ul"},"KCL Crossplane and Crossplane Provider series models: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://artifacthub.io/packages/search?org=kcl&sort=relevance&page=1&ts_query_web=crossplane"},"https://artifacthub.io/packages/search?org=kcl&sort=relevance&page=1&ts_query_web=crossplane")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\ud83d\udd27 Toolchain Update")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Documentation Tool Updates"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Support documentation generation for third-party libraries that models depend on, such as the ",(0,i.kt)("inlineCode",{parentName:"li"},"k8s")," module."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Validation Tool Updates"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Support validation results and error localization to YAML/JSON files, outputting error line and column number information."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Import Tool Updates"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Support mapping OpenAPI ",(0,i.kt)("inlineCode",{parentName:"li"},"multiplyOf")," specification to KCL ",(0,i.kt)("inlineCode",{parentName:"li"},"multiplyof")," function for validation."),(0,i.kt)("li",{parentName:"ul"},"Support outputting YAML Stream format Kubernetes CRD files into multiple KCL files."),(0,i.kt)("li",{parentName:"ul"},"Optimize KCL code generation by removing empty check statements.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\ud83c\udfc4 SDK Update")),(0,i.kt)("p",null,"In addition to the existing Go and Python SDKs in KCL, a new Rust SDK has been added (without LLVM dependency), which includes APIs for KCL file compilation, validation, testing, and code formatting."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\ud83d\udcbb IDE Updates")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Developer Experience"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Support incremental parsing and asynchronous compilation to enhance performance."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Bug Fixes"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Fixed the issue where string interpolation variables in assert statements cannot be navigated."),(0,i.kt)("li",{parentName:"ul"},"Fixed the issue where exceptional triggering of function completion in strings."),(0,i.kt)("li",{parentName:"ul"},"Fixed the issue with alias semantic check and completion in import statements."),(0,i.kt)("li",{parentName:"ul"},"Fixed the issue with check expression completion in schemas.")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\ud83d\udcd2 Documentation Updates")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Added index cards for KCL system library documentation for easy navigation: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://kcl-lang.io/docs/reference/model/overview"},"https://kcl-lang.io/docs/reference/model/overview"))),(0,i.kt)("li",{parentName:"ul"},"Updated KCL CLI reference documentation: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://kcl-lang.io/docs/tools/cli/kcl/overview"},"https://kcl-lang.io/docs/tools/cli/kcl/overview"))),(0,i.kt)("li",{parentName:"ul"},"Updated KCL API reference documentation: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://kcl-lang.io/docs/reference/xlang-api/overview"},"https://kcl-lang.io/docs/reference/xlang-api/overview"))),(0,i.kt)("li",{parentName:"ul"},"KCL 2023 & 2024 Roadmap document: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://kcl-lang.io/docs/community/release-policy/roadmap"},"https://kcl-lang.io/docs/community/release-policy/roadmap"))),(0,i.kt)("li",{parentName:"ul"},"Supplemented project structure introduction and FAQ for Intellij KCL repository: ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://github.com/kcl-lang/intellij-kcl/pull/18"},"https://github.com/kcl-lang/intellij-kcl/pull/18")))),(0,i.kt)("h2",{id:"special-thanks"},"Special Thanks"),(0,i.kt)("p",null,"The following are listed in no particular order:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Thanks to @professorabhay for supporting KCL testing diff function \ud83d\ude4c ",(0,i.kt)("em",{parentName:"li"},(0,i.kt)("a",{parentName:"em",href:"https://github.com/kcl-lang/kcl/issues/940"},"https://github.com/kcl-lang/kcl/issues/940"))),(0,i.kt)("li",{parentName:"ul"},"Thanks to @patrycju, @Callum Lyall, @Even Solberg, @Matt Gowie, and @ShiroDN for their valuable feedback and discussions during the promotion and usage of KCL \ud83d\ude4c")),(0,i.kt)("h2",{id:"featured-updates"},"Featured Updates"),(0,i.kt)("h3",{id:"using-kubernetes-strategy-merge-patch-to-update-configurations-in-kcl"},"Using Kubernetes Strategy Merge Patch to Update Configurations in KCL"),(0,i.kt)("p",null,"In the current version of KCL, various ",(0,i.kt)("strong",{parentName:"p"},"attribute operators")," are supported to update and override configurations. However, the capability is relatively atomic and cannot cover the typical configuration strategy scenarios in cloud-native environments."),(0,i.kt)("p",null,"For Kubernetes configurations, it is common to use the ",(0,i.kt)("inlineCode",{parentName:"p"},"JSON Merge Patch")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Strategy Merge Patch")," capabilities natively supported by Kubernetes e.g., using tools such as ",(0,i.kt)("inlineCode",{parentName:"p"},"kubectl patch"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"kustomize"),", and other patching capabilities supported by cloud-native configuration and policy tools."),(0,i.kt)("p",null,"To avoid repeatedly using KCL attribute operators to write configuration patch template codes when dealing with Kubernetes configurations, we provide the ",(0,i.kt)("strong",{parentName:"p"},"Kubernetes Strategy Merge Patch library")," for updating Kubernetes configurations. This library supports all merging strategies defined by native Kubernetes objects, such as overwriting, modifying, and adding items to list objects. Here is how to use it:"),(0,i.kt)("p",null,"Create a new project and add the Strategy Merge Patch library dependency:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"kcl mod init && kcl mod add strategic_merge_patch\n")),(0,i.kt)("p",null,"Write the configuration patch code in ",(0,i.kt)("inlineCode",{parentName:"p"},"main.k")," (using the ",(0,i.kt)("inlineCode",{parentName:"p"},"labels"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"replicas"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"container")," attributes of a ",(0,i.kt)("inlineCode",{parentName:"p"},"Deployment")," template as an example):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'import strategic_merge_patch as s\n\noriginal = {\n    apiVersion = "apps/v1"\n    kind = "Deployment"\n    metadata = {\n        name = "my-deployment"\n        labels.app = "my-app"\n    }\n    spec: {\n        replicas = 3\n        template.spec.containers = [\n            {\n                name = "my-container-1"\n                image = "my-image-1"\n            }\n            {\n                name = "my-container-2"\n                image = "my-image-2"\n            }\n        ]\n    }\n}\npatch = {\n    apiVersion = "apps/v1"\n    kind = "Deployment"\n    metadata = {\n        name = "my-deployment"\n        labels.version = "v1"\n    }\n    spec: {\n        replicas = 4\n        template.spec.containers = [\n            {\n                name = "my-container-1"\n                image = "my-new-image-1"\n            }\n            {\n                name = "my-container-3"\n                image = "my-image-3"\n            }\n        ]\n    }\n}\ngot = s.merge(original, patch)\n')),(0,i.kt)("p",null,"Run the command to get the output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"kcl run\n")),(0,i.kt)("p",null,"The output will be:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"original:\n  apiVersion: apps/v1\n  kind: Deployment\n  metadata:\n    name: my-deployment\n    labels:\n      app: my-app\n  spec:\n    replicas: 3\n    template:\n      spec:\n        containers:\n          - name: my-container-1\n            image: my-image-1\n          - name: my-container-2\n            image: my-image-2\npatch:\n  apiVersion: apps/v1\n  kind: Deployment\n  metadata:\n    name: my-deployment\n    labels:\n      version: v1\n  spec:\n    replicas: 4\n    template:\n      spec:\n        containers:\n          - name: my-container-1\n            image: my-new-image-1\n          - name: my-container-3\n            image: my-image-3\ngot:\n  apiVersion: apps/v1\n  kind: Deployment\n  metadata:\n    name: my-deployment\n    labels:\n      app: my-app\n      version: v1\n  spec:\n    replicas: 4\n    template:\n      spec:\n        containers:\n          - name: my-container-1\n            image: my-new-image-1\n          - name: my-container-2\n            image: my-image-2\n          - name: my-container-3\n            image: my-image-3\n")),(0,i.kt)("p",null,"As seen in the output, the labels, replicas, and container fields of the Deployment template have all been updated with the correct values. For more documentation and usage examples, please refer to ",(0,i.kt)("a",{parentName:"p",href:"https://artifacthub.io/packages/kcl/kcl-module/strategic_merge_patch"},"the document"),"."),(0,i.kt)("h2",{id:"resources"},"Resources"),(0,i.kt)("p",null,"\u2764\ufe0f Thanks to all KCL users and community members for their valuable feedback and suggestions in the community. See ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/kcl-lang/community"},"here")," to join us!"),(0,i.kt)("p",null,"For more resources, please refer to"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://kcl-lang.io/"},"KCL Website")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://kusionstack.io/"},"KusionStack Website")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/kcl-lang/kcl/milestone/8"},"KCL v0.8.0 Milestone"))))}u.isMDXComponent=!0},57702:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/biweekly-newsletter-fbbce78fb9c12bfc7ceee05a0a5f8870.png"}}]);